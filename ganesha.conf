# NFS-Ganesha configuration for Raspberry Pi network boot

# NFS core settings
NFS_CORE_PARAM {
    # Disable NLM (Network Lock Manager) - not needed for read-mostly boot
    Enable_NLM = false;
    # Disable RQUOTA
    Enable_RQUOTA = false;
    # NFS protocols to enable
    Protocols = 3, 4;
    # Bind to IPv4 only
    Bind_addr = 0.0.0.0;
}

# NFSv4 specific settings
NFSV4 {
    # Disable NFSv4 delegations
    Delegations = false;
    # Grace period in seconds
    Grace_Period = 0;
}

# Export the Raspberry Pi root filesystem
EXPORT {
    # Unique export ID
    Export_Id = 1;

    # Path to export
    Path = /nfs/rpi/rootfs;

    # Pseudo path for NFSv4 (must start with /)
    Pseudo = /rpi/rootfs;

    # Access type
    Access_Type = RW;

    # Squash settings - no_root_squash equivalent
    Squash = No_Root_Squash;

    # Allow all clients (equivalent to * in /etc/exports)
    # CHANGEME: For production, restrict to specific IP/subnet
    CLIENT {
        Clients = *;
        Access_Type = RW;
        Squash = No_Root_Squash;
    }

    # FSAL (File System Abstraction Layer) - use VFS for regular filesystem
    FSAL {
        Name = VFS;
    }

    # Disable security flavors (for simplicity, like in VM setup)
    SecType = sys;
}

# Logging configuration
LOG {
    Default_Log_Level = WARN;

    Components {
        ALL = WARN;
    }
}
